<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Training Analytics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                <h1 class="text-2xl font-bold text-gray-900 mb-4 md:mb-0">Employee Training Analytics & Management</h1>
                <div class="flex flex-col sm:flex-row gap-3">
                    <select id="trainingTypeFilter" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All Training Types</option>
                        <option value="guardian-ai">Guardian AI</option>
                        <option value="speech-practice">Speech Practice</option>
                        <option value="tts">Text-to-Speech</option>
                        <option value="phonetic">Phonetic Pronunciation</option>
                        <option value="eligibility">Eligibility Verification</option>
                    </select>
                    <select id="departmentFilter" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All Departments</option>
                    </select>
                    <button onclick="generateTrainingReport()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                        <i class="fas fa-chart-bar mr-2"></i>Generate Report
                    </button>
                </div>
            </div>
        </div>

        <!-- Training Overview Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Active Training Sessions</p>
                        <p class="text-3xl font-bold text-blue-600" id="activeSessions">--</p>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-play-circle text-blue-600 text-xl"></i>
                    </div>
                </div>
                <p class="text-sm text-gray-500 mt-2" id="sessionsToday">-- sessions today</p>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Completion Rate</p>
                        <p class="text-3xl font-bold text-green-600" id="completionRate">--%</p>
                    </div>
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-graduation-cap text-green-600 text-xl"></i>
                    </div>
                </div>
                <p class="text-sm text-gray-500 mt-2" id="completionTrend">+-- vs last week</p>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Avg Training Time</p>
                        <p class="text-3xl font-bold text-purple-600" id="avgTrainingTime">--</p>
                    </div>
                    <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-clock text-purple-600 text-xl"></i>
                    </div>
                </div>
                <p class="text-sm text-gray-500 mt-2" id="timeImprovement">-- improvement</p>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Skills Mastered</p>
                        <p class="text-3xl font-bold text-orange-600" id="skillsMastered">--</p>
                    </div>
                    <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-star text-orange-600 text-xl"></i>
                    </div>
                </div>
                <p class="text-sm text-gray-500 mt-2" id="skillsProgress">-- in progress</p>
            </div>
        </div>

        <!-- Training Analytics Charts -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Training Progress by Type</h3>
                <canvas id="trainingProgressChart" width="400" height="200"></canvas>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Weekly Training Activity</h3>
                <canvas id="weeklyActivityChart" width="400" height="200"></canvas>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Employee Performance Distribution</h3>
                <canvas id="performanceChart" width="400" height="200"></canvas>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Training Module Effectiveness</h3>
                <canvas id="effectivenessChart" width="400" height="200"></canvas>
            </div>
        </div>

        <!-- Top Performers Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Top Performing Employees</h3>
                <div id="topPerformers" class="space-y-4">
                    <!-- Top performers will be loaded here -->
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Training Alerts & Recommendations</h3>
                <div id="trainingAlerts" class="space-y-4">
                    <!-- Training alerts will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Training Usage Analytics -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Training Module Usage Analytics</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <!-- Guardian AI Usage -->
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-lg border border-blue-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-blue-900">Guardian AI</h4>
                        <i class="fas fa-robot text-blue-600 text-xl"></i>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-blue-700">Sessions:</span>
                            <span class="font-bold" id="guardianAiSessions">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-blue-700">Avg Duration:</span>
                            <span class="font-bold" id="guardianAiDuration">-- min</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-blue-700">Success Rate:</span>
                            <span class="font-bold" id="guardianAiSuccess">--%</span>
                        </div>
                    </div>
                </div>

                <!-- Speech Practice Usage -->
                <div class="bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg border border-green-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-green-900">Speech Practice</h4>
                        <i class="fas fa-microphone text-green-600 text-xl"></i>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-green-700">Sessions:</span>
                            <span class="font-bold" id="speechSessions">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-green-700">Avg Duration:</span>
                            <span class="font-bold" id="speechDuration">-- min</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-green-700">Improvement:</span>
                            <span class="font-bold" id="speechImprovement">--%</span>
                        </div>
                    </div>
                </div>

                <!-- TTS Usage -->
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-lg border border-purple-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-purple-900">Text-to-Speech</h4>
                        <i class="fas fa-volume-up text-purple-600 text-xl"></i>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-purple-700">Sessions:</span>
                            <span class="font-bold" id="ttsSessions">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-purple-700">Texts Processed:</span>
                            <span class="font-bold" id="ttsTexts">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-purple-700">Accuracy:</span>
                            <span class="font-bold" id="ttsAccuracy">--%</span>
                        </div>
                    </div>
                </div>

                <!-- Phonetic Training -->
                <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-4 rounded-lg border border-orange-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-orange-900">Phonetic Training</h4>
                        <i class="fas fa-language text-orange-600 text-xl"></i>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-orange-700">Sessions:</span>
                            <span class="font-bold" id="phoneticSessions">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-orange-700">Words Learned:</span>
                            <span class="font-bold" id="phoneticWords">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-orange-700">Mastery:</span>
                            <span class="font-bold" id="phoneticMastery">--%</span>
                        </div>
                    </div>
                </div>

                <!-- Eligibility Training -->
                <div class="bg-gradient-to-br from-teal-50 to-teal-100 p-4 rounded-lg border border-teal-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-teal-900">Eligibility</h4>
                        <i class="fas fa-check-circle text-teal-600 text-xl"></i>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-teal-700">Sessions:</span>
                            <span class="font-bold" id="eligibilitySessions">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-teal-700">Verifications:</span>
                            <span class="font-bold" id="eligibilityVerifications">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-teal-700">Accuracy:</span>
                            <span class="font-bold" id="eligibilityAccuracy">--%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Training Table -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Individual Training Progress</h3>
                <div class="flex gap-2">
                    <button onclick="exportTrainingData()" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors">
                        <i class="fas fa-download mr-2"></i>Export
                    </button>
                    <button onclick="assignTraining()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>Assign Training
                    </button>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Employee</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Guardian AI</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Speech Practice</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">TTS</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Phonetic</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eligibility</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Overall Score</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Activity</th>
                        </tr>
                    </thead>
                    <tbody id="trainingTableBody" class="bg-white divide-y divide-gray-200">
                        <!-- Training data will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:5000/api';
        let trainingData = [];
        let employeesData = [];
        let trainingProgressChart, weeklyActivityChart, performanceChart, effectivenessChart;

        // Mock training data
        const mockTrainingData = [
            {
                employeeId: 'EMP001',
                employeeName: 'Alice Johnson',
                department: 'Customer Service',
                guardianAI: { sessions: 15, duration: 45, score: 85 },
                speechPractice: { sessions: 12, duration: 30, score: 78 },
                tts: { sessions: 8, texts: 120, score: 92 },
                phonetic: { sessions: 10, words: 85, score: 88 },
                eligibility: { sessions: 6, verifications: 45, score: 76 },
                overallScore: 84,
                lastActivity: '2024-01-20',
                totalHours: 12.5
            },
            {
                employeeId: 'EMP002',
                employeeName: 'Bob Martinez',
                department: 'Claims Processing',
                guardianAI: { sessions: 20, duration: 38, score: 91 },
                speechPractice: { sessions: 18, duration: 35, score: 89 },
                tts: { sessions: 12, texts: 180, score: 87 },
                phonetic: { sessions: 15, words: 125, score: 93 },
                eligibility: { sessions: 8, verifications: 62, score: 85 },
                overallScore: 89,
                lastActivity: '2024-01-21',
                totalHours: 18.2
            },
            {
                employeeId: 'EMP003',
                employeeName: 'Carol Smith',
                department: 'Patient Care',
                guardianAI: { sessions: 8, duration: 52, score: 72 },
                speechPractice: { sessions: 6, duration: 28, score: 65 },
                tts: { sessions: 4, texts: 60, score: 78 },
                phonetic: { sessions: 5, words: 40, score: 68 },
                eligibility: { sessions: 3, verifications: 18, score: 62 },
                overallScore: 69,
                lastActivity: '2024-01-18',
                totalHours: 6.8
            }
        ];

        async function loadEmployees() {
            try {
                const response = await fetch(`${API_BASE_URL}/employees`);
                employeesData = await response.json();
                
                // Populate department filter
                const departments = [...new Set(employeesData.map(emp => emp.department).filter(dept => dept))];
                const departmentFilter = document.getElementById('departmentFilter');
                
                departments.forEach(dept => {
                    const option = document.createElement('option');
                    option.value = dept;
                    option.textContent = dept;
                    departmentFilter.appendChild(option);
                });
            } catch (error) {
                console.error('Error loading employees:', error);
                employeesData = [];
            }
        }

        async function loadTrainingData() {
            try {
                // TODO: Replace with actual API call
                // const response = await fetch(`${API_BASE_URL}/training-analytics`);
                // trainingData = await response.json();
                
                // Using mock data for now
                trainingData = mockTrainingData;
                
                updateSummaryCards();
                generateCharts();
                updateTrainingTable();
                updateTopPerformers();
                updateTrainingAlerts();
                updateModuleUsage();
            } catch (error) {
                console.error('Error loading training data:', error);
                trainingData = mockTrainingData;
                updateSummaryCards();
                generateCharts();
                updateTrainingTable();
                updateTopPerformers();
                updateTrainingAlerts();
                updateModuleUsage();
            }
        }

        function updateSummaryCards() {
            const totalSessions = trainingData.reduce((sum, emp) => 
                sum + emp.guardianAI.sessions + emp.speechPractice.sessions + emp.tts.sessions + 
                emp.phonetic.sessions + emp.eligibility.sessions, 0);
            
            const avgScore = trainingData.reduce((sum, emp) => sum + emp.overallScore, 0) / trainingData.length;
            const avgHours = trainingData.reduce((sum, emp) => sum + emp.totalHours, 0) / trainingData.length;
            const skillsMastered = trainingData.filter(emp => emp.overallScore >= 80).length;
            const skillsInProgress = trainingData.filter(emp => emp.overallScore < 80 && emp.overallScore >= 60).length;

            // Sessions today (mock calculation)
            const sessionsToday = Math.floor(totalSessions * 0.1);

            document.getElementById('activeSessions').textContent = totalSessions;
            document.getElementById('completionRate').textContent = `${Math.round(avgScore)}%`;
            document.getElementById('avgTrainingTime').textContent = `${avgHours.toFixed(1)}h`;
            document.getElementById('skillsMastered').textContent = skillsMastered;
            
            document.getElementById('sessionsToday').textContent = `${sessionsToday} sessions today`;
            document.getElementById('completionTrend').textContent = '+12% vs last week';
            document.getElementById('timeImprovement').textContent = '15% improvement';
            document.getElementById('skillsProgress').textContent = `${skillsInProgress} in progress`;
        }

        function generateCharts() {
            generateTrainingProgressChart();
            generateWeeklyActivityChart();
            generatePerformanceChart();
            generateEffectivenessChart();
        }

        function generateTrainingProgressChart() {
            const modules = ['Guardian AI', 'Speech Practice', 'TTS', 'Phonetic', 'Eligibility'];
            const avgScores = [
                trainingData.reduce((sum, emp) => sum + emp.guardianAI.score, 0) / trainingData.length,
                trainingData.reduce((sum, emp) => sum + emp.speechPractice.score, 0) / trainingData.length,
                trainingData.reduce((sum, emp) => sum + emp.tts.score, 0) / trainingData.length,
                trainingData.reduce((sum, emp) => sum + emp.phonetic.score, 0) / trainingData.length,
                trainingData.reduce((sum, emp) => sum + emp.eligibility.score, 0) / trainingData.length
            ];

            const ctx = document.getElementById('trainingProgressChart').getContext('2d');
            if (trainingProgressChart) trainingProgressChart.destroy();
            
            trainingProgressChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: modules,
                    datasets: [{
                        label: 'Average Scores',
                        data: avgScores,
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        pointBackgroundColor: 'rgb(59, 130, 246)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(59, 130, 246)'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        function generateWeeklyActivityChart() {
            const last7Days = [];
            const activityData = [];
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                last7Days.push(date.toLocaleDateString('en-US', { weekday: 'short' }));
                
                // Mock activity calculation
                const activity = Math.floor(Math.random() * 20) + 10;
                activityData.push(activity);
            }

            const ctx = document.getElementById('weeklyActivityChart').getContext('2d');
            if (weeklyActivityChart) weeklyActivityChart.destroy();
            
            weeklyActivityChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: last7Days,
                    datasets: [{
                        label: 'Training Sessions',
                        data: activityData,
                        borderColor: 'rgb(16, 185, 129)',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function generatePerformanceChart() {
            const performanceRanges = {
                'Excellent (90-100)': 0,
                'Good (80-89)': 0,
                'Average (70-79)': 0,
                'Needs Improvement (60-69)': 0,
                'Poor (<60)': 0
            };

            trainingData.forEach(emp => {
                const score = emp.overallScore;
                if (score >= 90) performanceRanges['Excellent (90-100)']++;
                else if (score >= 80) performanceRanges['Good (80-89)']++;
                else if (score >= 70) performanceRanges['Average (70-79)']++;
                else if (score >= 60) performanceRanges['Needs Improvement (60-69)']++;
                else performanceRanges['Poor (<60)']++;
            });

            const ctx = document.getElementById('performanceChart').getContext('2d');
            if (performanceChart) performanceChart.destroy();
            
            performanceChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(performanceRanges),
                    datasets: [{
                        data: Object.values(performanceRanges),
                        backgroundColor: [
                            '#10B981',
                            '#3B82F6',
                            '#F59E0B',
                            '#EF4444',
                            '#6B7280'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function generateEffectivenessChart() {
            const modules = ['Guardian AI', 'Speech Practice', 'TTS', 'Phonetic', 'Eligibility'];
            const effectiveness = [88, 75, 92, 85, 72]; // Mock effectiveness scores

            const ctx = document.getElementById('effectivenessChart').getContext('2d');
            if (effectivenessChart) effectivenessChart.destroy();
            
            effectivenessChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: modules,
                    datasets: [{
                        label: 'Effectiveness Score',
                        data: effectiveness,
                        backgroundColor: [
                            '#3B82F6',
                            '#10B981',
                            '#8B5CF6',
                            '#F59E0B',
                            '#06B6D4'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        function updateTopPerformers() {
            const topPerformers = [...trainingData]
                .sort((a, b) => b.overallScore - a.overallScore)
                .slice(0, 5);

            const container = document.getElementById('topPerformers');
            
            container.innerHTML = topPerformers.map((emp, index) => {
                const rankColors = ['text-yellow-600', 'text-gray-500', 'text-orange-600', 'text-blue-600', 'text-green-600'];
                const rankIcons = ['fa-trophy', 'fa-medal', 'fa-award', 'fa-star', 'fa-star'];
                
                return `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <div class="w-8 h-8 flex items-center justify-center">
                                <i class="fas ${rankIcons[index]} ${rankColors[index]} text-lg"></i>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-900">${emp.employeeName}</p>
                                <p class="text-xs text-gray-500">${emp.department}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-lg font-bold text-gray-900">${emp.overallScore}%</p>
                            <p class="text-xs text-gray-500">${emp.totalHours}h trained</p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateTrainingAlerts() {
            const alerts = [
                {
                    type: 'warning',
                    icon: 'fa-exclamation-triangle',
                    color: 'yellow',
                    title: 'Low Participation',
                    message: 'Carol Smith has not accessed training in 3 days',
                    action: 'Send Reminder'
                },
                {
                    type: 'success',
                    icon: 'fa-check-circle',
                    color: 'green',
                    title: 'Module Complete',
                    message: 'Bob Martinez completed Guardian AI training',
                    action: 'View Certificate'
                },
                {
                    type: 'info',
                    icon: 'fa-info-circle',
                    color: 'blue',
                    title: 'New Module Available',
                    message: 'Advanced Phonetic Training is now available',
                    action: 'Assign Training'
                }
            ];

            const container = document.getElementById('trainingAlerts');
            
            container.innerHTML = alerts.map(alert => `
                <div class="border border-${alert.color}-200 bg-${alert.color}-50 rounded-lg p-4">
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <i class="fas ${alert.icon} text-${alert.color}-600"></i>
                        </div>
                        <div class="ml-3 flex-1">
                            <h4 class="text-sm font-medium text-${alert.color}-900">${alert.title}</h4>
                            <p class="text-sm text-${alert.color}-700 mt-1">${alert.message}</p>
                            <button class="mt-2 text-xs bg-${alert.color}-600 text-white px-3 py-1 rounded hover:bg-${alert.color}-700 transition-colors">
                                ${alert.action}
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function updateModuleUsage() {
            // Guardian AI
            const guardianAiSessions = trainingData.reduce((sum, emp) => sum + emp.guardianAI.sessions, 0);
            const guardianAiDuration = trainingData.reduce((sum, emp) => sum + emp.guardianAI.duration, 0) / trainingData.length;
            const guardianAiSuccess = trainingData.reduce((sum, emp) => sum + emp.guardianAI.score, 0) / trainingData.length;
            
            document.getElementById('guardianAiSessions').textContent = guardianAiSessions;
            document.getElementById('guardianAiDuration').textContent = `${guardianAiDuration.toFixed(0)} min`;
            document.getElementById('guardianAiSuccess').textContent = `${guardianAiSuccess.toFixed(0)}%`;

            // Speech Practice
            const speechSessions = trainingData.reduce((sum, emp) => sum + emp.speechPractice.sessions, 0);
            const speechDuration = trainingData.reduce((sum, emp) => sum + emp.speechPractice.duration, 0) / trainingData.length;
            const speechImprovement = trainingData.reduce((sum, emp) => sum + emp.speechPractice.score, 0) / trainingData.length;
            
            document.getElementById('speechSessions').textContent = speechSessions;
            document.getElementById('speechDuration').textContent = `${speechDuration.toFixed(0)} min`;
            document.getElementById('speechImprovement').textContent = `${speechImprovement.toFixed(0)}%`;

            // TTS
            const ttsSessions = trainingData.reduce((sum, emp) => sum + emp.tts.sessions, 0);
            const ttsTexts = trainingData.reduce((sum, emp) => sum + emp.tts.texts, 0);
            const ttsAccuracy = trainingData.reduce((sum, emp) => sum + emp.tts.score, 0) / trainingData.length;
            
            document.getElementById('ttsSessions').textContent = ttsSessions;
            document.getElementById('ttsTexts').textContent = ttsTexts;
            document.getElementById('ttsAccuracy').textContent = `${ttsAccuracy.toFixed(0)}%`;

            // Phonetic
            const phoneticSessions = trainingData.reduce((sum, emp) => sum + emp.phonetic.sessions, 0);
            const phoneticWords = trainingData.reduce((sum, emp) => sum + emp.phonetic.words, 0);
            const phoneticMastery = trainingData.reduce((sum, emp) => sum + emp.phonetic.score, 0) / trainingData.length;
            
            document.getElementById('phoneticSessions').textContent = phoneticSessions;
            document.getElementById('phoneticWords').textContent = phoneticWords;
            document.getElementById('phoneticMastery').textContent = `${phoneticMastery.toFixed(0)}%`;

            // Eligibility
            const eligibilitySessions = trainingData.reduce((sum, emp) => sum + emp.eligibility.sessions, 0);
            const eligibilityVerifications = trainingData.reduce((sum, emp) => sum + emp.eligibility.verifications, 0);
            const eligibilityAccuracy = trainingData.reduce((sum, emp) => sum + emp.eligibility.score, 0) / trainingData.length;
            
            document.getElementById('eligibilitySessions').textContent = eligibilitySessions;
            document.getElementById('eligibilityVerifications').textContent = eligibilityVerifications;
            document.getElementById('eligibilityAccuracy').textContent = `${eligibilityAccuracy.toFixed(0)}%`;
        }

        function updateTrainingTable() {
            const tbody = document.getElementById('trainingTableBody');
            const departmentFilter = document.getElementById('departmentFilter').value;
            
            let filteredData = trainingData;
            if (departmentFilter) {
                filteredData = trainingData.filter(emp => emp.department === departmentFilter);
            }

            if (filteredData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="px-6 py-4 text-center text-gray-500">
                            No training data found for the selected criteria
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = filteredData.map(emp => {
                const getScoreColor = (score) => {
                    if (score >= 90) return 'text-green-600 bg-green-100';
                    if (score >= 80) return 'text-blue-600 bg-blue-100';
                    if (score >= 70) return 'text-yellow-600 bg-yellow-100';
                    if (score >= 60) return 'text-orange-600 bg-orange-100';
                    return 'text-red-600 bg-red-100';
                };

                return `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">${emp.employeeName}</div>
                            <div class="text-sm text-gray-500">${emp.department}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 py-1 text-xs font-semibold rounded-full ${getScoreColor(emp.guardianAI.score)}">
                                ${emp.guardianAI.score}%
                            </span>
                            <div class="text-xs text-gray-500">${emp.guardianAI.sessions} sessions</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 py-1 text-xs font-semibold rounded-full ${getScoreColor(emp.speechPractice.score)}">
                                ${emp.speechPractice.score}%
                            </span>
                            <div class="text-xs text-gray-500">${emp.speechPractice.sessions} sessions</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 py-1 text-xs font-semibold rounded-full ${getScoreColor(emp.tts.score)}">
                                ${emp.tts.score}%
                            </span>
                            <div class="text-xs text-gray-500">${emp.tts.sessions} sessions</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 py-1 text-xs font-semibold rounded-full ${getScoreColor(emp.phonetic.score)}">
                                ${emp.phonetic.score}%
                            </span>
                            <div class="text-xs text-gray-500">${emp.phonetic.sessions} sessions</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 py-1 text-xs font-semibold rounded-full ${getScoreColor(emp.eligibility.score)}">
                                ${emp.eligibility.score}%
                            </span>
                            <div class="text-xs text-gray-500">${emp.eligibility.sessions} sessions</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-3 py-1 text-sm font-bold rounded-full ${getScoreColor(emp.overallScore)}">
                                ${emp.overallScore}%
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${new Date(emp.lastActivity).toLocaleDateString()}
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function generateTrainingReport() {
            // TODO: Implement comprehensive training report generation
            alert('Training report generation functionality - to be implemented');
        }

        function exportTrainingData() {
            const headers = ['Employee', 'Department', 'Guardian AI', 'Speech Practice', 'TTS', 'Phonetic', 'Eligibility', 'Overall Score', 'Total Hours', 'Last Activity'];
            const csvContent = [
                headers.join(','),
                ...trainingData.map(emp => [
                    `"${emp.employeeName}"`,
                    `"${emp.department}"`,
                    emp.guardianAI.score,
                    emp.speechPractice.score,
                    emp.tts.score,
                    emp.phonetic.score,
                    emp.eligibility.score,
                    emp.overallScore,
                    emp.totalHours,
                    emp.lastActivity
                ].join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `training-analytics-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function assignTraining() {
            // TODO: Implement training assignment functionality
            alert('Training assignment functionality - to be implemented');
        }

        // Event listeners
        document.getElementById('departmentFilter').addEventListener('change', updateTrainingTable);
        document.getElementById('trainingTypeFilter').addEventListener('change', updateTrainingTable);

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadEmployees();
            loadTrainingData();
        });
    </script>
</body>
</html>